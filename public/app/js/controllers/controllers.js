'use strict';

/* Controllers */

angular.module('caf.controllers', [])
  .controller('mainCtrl', ['$scope','$location','$anchorScroll', function($scope, $location, $anchorScroll) {
    $scope.test = 'Wolrd';
  }])
  .controller('leaderboardCtrl', ['$scope', function($scope) {
    $scope.test = 'leaderboardCtrl';
  }])
  .controller('users', ['$scope', '$routeParams', '$angularCacheFactory','Users', function($scope, $routeParams, $angularCacheFactory, Users) {

    var userId = $routeParams.userId ? $routeParams.userId : false;
    console.log(userId)

    if(!userId)
      $scope.users = Users.query();
    else{
      $angularCacheFactory.info();

      var usersCache = $angularCacheFactory.get('usersCache');
      console.log(usersCache);
      var userProfileCached = usersCache.get('/users/'+userId);

      console.log(userProfileCached);
      if(!userProfileCached) {
        var userInfos = Users.get({userId: userId});
        
        usersCache.put('/users/'+userId, userInfos);
        $scope.user = userInfos;

      } else {
        $scope.user = userProfileCached;        
      }

    }
  }])
  .controller('MenuLeftCtrl', function($location, $scope) {
    $scope.currentUser = {"__v":3,"_id":{"$oid":"534d4bd671cfa9841c5883ec"},"challengeCompleted":[],"challengeRate":[],"challengeRateHistoric":[],"daily":{"level":0,"shareFB":0,"shareTW":0,"xp":0},"dailyArchives":[{"_id":{"$oid":"534d4bd671cfa9841c5883ec"},"date":{"$date":"2014-04-16T13:00:00.764Z"},"shareTW":0,"shareFB":0,"level":2,"xp":165,"rank":0},{"_id":{"$oid":"534d4bd671cfa9841c5883ec"},"date":{"$date":"2014-04-17T11:00:04.851Z"},"shareTW":0,"shareFB":0,"level":7,"xp":2140,"rank":0},{"_id":{"$oid":"534d4bd671cfa9841c5883ec"},"date":{"$date":"2014-04-17T13:00:00.695Z"},"shareTW":0,"shareFB":0,"level":7,"xp":2140,"rank":0}],"dailyRank":1,"dailyScore":0,"facebook":{"email":"xspirits@gmail.com","id":"595551668","name":"Tom Plx","token":"CAAI4WFn0zWoBAE8E2B1upEq8uLp5rDFLC3MRZAFq3bQpHNTjO0AnSXiwmZB4LqcZAe2JYOeVPRufc9BARWBOciLD27jwOSBOjXc1VZAAFMS5R5yAS5gQbFtH1Va0WHLmOrXMSYgJjFFHgfHNNbIpdx9IpY6Gz1LIse9a5EfvU07POln3dloZAwttnfKMFZCvcZD"},"fbInvitedFriends":[579585536,647673628,518006943,1839386947,524789860,541273356,550918118,553373801,1168845405,100002948771624],"followers":[],"friends":[],"global":{"shareTW":0,"shareFB":0},"globalScore":17120,"icon":"http://gravatar.com/avatar/1334aaae9731d0d0fa98c2264c54fa5a?s=150&d=identicon&r=g","idCool":"9QAWgh","isOnline":true,"leagueoflegend":{"idProfile":19030313,"name":"Krakl3","confirmed":true,"region":"euw","profileIconId":518,"revisionDate":{"$date":"46185-10-28T13:33:20.000Z"},"summonerLevel":30,"profileIconId_confirm":11},"level":7,"local":{"pseudo":"Xspirits","password":"$2a$08$AUtcyvtE5aYVhBRhajg3deakI6qkZsG9HBpcGP7JdxKhnjtav9dBW","email":"xspirits@gmail.com","joinDate":{"$date":"2014-04-15T15:10:14.214Z"}},"monthly":{"shareTW":0,"shareFB":0,"level":6,"xp":2140},"monthlyArchives":[],"monthlyRank":0,"monthlyScore":0,"notifications":[{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534d4bd671cfa9841c5883ed"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating an account","date":{"$date":"2014-04-15T15:10:14.563Z"},"title":"You gained 55 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534d93fe094dc80b00e2d8e5"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"Congratulation! ","date":{"$date":"2014-04-15T20:18:06.605Z"},"title":"You have reached level  2!","to":"","from":"Xspirits","icon":"fa fa-arrow-up"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534d93fe094dc80b00e2d8e7"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating a new challenge","date":{"$date":"2014-04-15T20:18:06.607Z"},"title":"You gained 110 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e7ed0288f440b000b9b04"},"isSeen":true,"type":"newLadderRank","persist":true,"notificationType":"info","link2":"","link1":"./leaderboard","message":"","date":{"$date":"2014-04-16T13:00:00.813Z"},"title":"Congratulation!! You are now ranked 1","to":"","from":"Challenge Master","icon":"fa fa-star"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e95b14a3191482ba4d2e2"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T14:37:37.987Z"},"title":"You gained 75 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e96464d9e0f8004c43b17"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"Congratulation! ","date":{"$date":"2014-04-16T14:40:06.954Z"},"title":"You have reached level  3!","to":"","from":"Xspirits","icon":"fa fa-arrow-up"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e96464d9e0f8004c43b19"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T14:40:06.957Z"},"title":"You gained 75 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e97124d9e0f8004c43b1a"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T14:43:30.119Z"},"title":"You gained 75 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e98523803fd8c1d2519c4"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T14:48:50.120Z"},"title":"You gained 150 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e98a7c6fbe2c0181b3f94"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"Congratulation! ","date":{"$date":"2014-04-16T14:50:15.279Z"},"title":"You have reached level  4!","to":"","from":"Xspirits","icon":"fa fa-arrow-up"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e98a7c6fbe2c0181b3f96"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T14:50:15.285Z"},"title":"You gained 150 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9a48c0e546b015a74c1f"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T14:57:12.619Z"},"title":"You gained 150 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9be5ecdbd7fc09b8ee1f"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T15:04:05.786Z"},"title":"You gained 150 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9c27ecdbd7fc09b8ee20"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"Congratulation! ","date":{"$date":"2014-04-16T15:05:11.299Z"},"title":"You have reached level  5!","to":"","from":"Xspirits","icon":"fa fa-arrow-up"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9c27ecdbd7fc09b8ee22"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by Inviting friends from Facebook","date":{"$date":"2014-04-16T15:05:11.301Z"},"title":"You gained 150 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9f7deb3348b413a771de"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating a new challenge","date":{"$date":"2014-04-16T15:19:25.169Z"},"title":"You gained 110 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9f8ceb3348b413a771e1"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating a new challenge","date":{"$date":"2014-04-16T15:19:40.217Z"},"title":"You gained 110 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9f90eb3348b413a771e4"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating a new challenge","date":{"$date":"2014-04-16T15:19:44.841Z"},"title":"You gained 110 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9f98eb3348b413a771e7"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating a new challenge","date":{"$date":"2014-04-16T15:19:52.769Z"},"title":"You gained 110 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9f9eeb3348b413a771ea"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"Congratulation!","date":{"$date":"2014-04-16T15:19:58.800Z"},"title":"You have reached level  7!","to":"","from":"Xspirits","icon":"fa fa-arrow-up"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534e9f9eeb3348b413a771ec"},"isSeen":true,"type":"simple","persist":true,"notificationType":"info","link2":"","link1":"/u/9QAWgh","message":"by creating a new challenge","date":{"$date":"2014-04-16T15:19:58.802Z"},"title":"You gained 110 xp.","to":"","from":"Xspirits","icon":"fa fa-plus-square-o"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534fb4355da0e970180aacf3"},"isSeen":true,"type":"newLadderRank","persist":true,"notificationType":"info","link2":"","link1":"./leaderboard","message":"","date":{"$date":"2014-04-17T11:00:05.265Z"},"title":"Congratulation!! You are now ranked 1","to":"","from":"Challenge Master","icon":"fa fa-star"},{"idFrom":{"$oid":"534d4bd671cfa9841c5883ec"},"_id":{"$oid":"534fd0508ea3ad0b005fdbf5"},"isSeen":false,"type":"newLadderRank","persist":true,"notificationType":"info","link2":"","link1":"./leaderboard","message":"","date":{"$date":"2014-04-17T13:00:00.740Z"},"title":"Congratulation!! You are now ranked 1","to":"","from":"Challenge Master","icon":"fa fa-star"}],"pendingRequests":[],"sentRequests":[],"share":{"twitter":true,"facebook":true},"tribunal":[],"tribunalHistoric":[],"twitter":{"displayName":"Tom Plx","id":"80673759","token":"80673759-YjoQzUnRd2EFXt32zQCQEju5gKNUEUwEOWFPGrmTs","tokenSecret":"vJYoNRnzUYxOeHUJnOKh6YgxDSvLAlo7rRmTB0hvMc9og","username":"Xspirits"},"userRand":[0.31669664243236184,0],"verfiy_hash":"-wOZSQAsDR","verified":true,"weekly":{"shareTW":0,"shareFB":0,"level":6,"xp":2140},"weeklyArchives":[],"weeklyRank":0,"weeklyScore":0,"xp":2140,"xpDouble":false,"xpHistoric":[{"_id":{"$oid":"534e85d8288f440b000b9b05"},"date":{"$date":"2014-04-16T13:30:00.756Z"},"level":2,"xp":165},{"_id":{"$oid":"534fbb3a5da0e970180aacf4"},"date":{"$date":"2014-04-17T11:30:02.166Z"},"level":7,"xp":2140},{"_id":{"$oid":"534fd758e2d75b0b00e70941"},"date":{"$date":"2014-04-17T13:30:00.951Z"},"level":7,"xp":2140}],"xpNext":660};
    $scope.location = $location;
  });
